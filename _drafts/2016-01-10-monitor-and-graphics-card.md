---
title: 显示器与显卡
category: 硬件
tags:
- Graphics
---

### 显示器

今天的计算机显示其通常是液晶显示屏，过去曾经非常流行的是阴极射线管，也就是CRT显示器。这里先对CRT显示器的现实原理进行说明。

CRT 显示器利用阴极电子枪发射电子，通过电场给电子加速，使其射向荧光屏。同时使用水平、垂直的两个偏转磁场，让电子在射向荧光屏的过程中进行左右上下的运动，控制电子打在屏幕特定位置上，激发屏幕上的磷化物发光以显示颜色。早期的 CRT 只能通过电子束的强弱来区分显示光线的明暗，显示单色画面。彩色的 CRT 具有红、绿、蓝三种颜色的电子枪，分别可以激发屏幕显示不同颜色。

![阴极射线管原理图](https://upload.wikimedia.org/wikipedia/commons/e/e2/Cathode_ray_tube_diagram-en.svg)

阴极射线管的显示方式非常简单，电子枪发射电子，经过偏转磁场打在荧光屏上，激发屏幕上的荧光材料发光。由于电子束同一时间只能激活屏幕上的一个点，因此要显示一屏的图像就需要电子束将屏幕所有位置的荧光材料激活。当时有一种向量显示器，显示的内容是若干线段，显示的时候，电子束在CRT偏转磁场的作用下在屏幕上划出一道道线段。向量显示器制造相对容易，因为不需要偏转磁场频繁变化。但是向量显示器的显示内容有极大制约，于是后来人们采用另一种方式显示内容，让电子束从屏幕左上角开始逐行作向右的水平扫描，每扫描完一行之后再扫描下面的一行。扫描的过程中，所要显示的图像信息已经编码到电子束之中，在荧光屏上激发的颜色就是图像这一点的像素内容。

显像管的电视机同样使用这种方式显示。彩色的CRT显示器有多个电子枪，分别激发荧光屏上不同颜色的荧光剂。但基本都使用自左向右，从上到下的扫描顺序，每扫描到一个位置就将相应的颜色信息编码在电子枪中。通常显示器每秒刷新屏幕60次，也就是整屏的扫描一共进行60次，每次扫描的时候都需要各个像素点的颜色信息，这些信息是来自视频线的，因此视频线中的信息必须组织成所需的格式。常见的视频线接口是VGA，同时有一种显卡也叫做VGA，VGA接口就是VGA显卡所用的标准接口。VGA接口中传输的是模拟信号，因为CRT显示器所需的就是模拟信号，VGA会按照显示器需要的速度，将视频信息转变为脉冲流发送给显示器，这些信息包括每个像素点的颜色信息、水平同步、垂直同步。所谓水平同步，就是告诉显示器，这一行的信息已经发送完毕，接下来收到的信息就是下一行的内容，显示器应该将扫描线下移一行。垂直同步就是告诉显示器，这一屏的信息已经发送完毕，接下来收到的是下一屏，也就是下一帧的内容，显示器应该将扫描点恢复到屏幕左上角。

现在的LCD显示器兼容VGA接口，但LCD等新型显示器内部是数字化的，在使用VGA的时候，需要进行模数转换，将VGA的信息转换为显示器的内部表示。由于计算机视频信息原本是数字信息，经过显卡进行编码的时候执行了一次模数转换，在显示器中又进行了一次数模转换，所以显示效果可能有轻微失真。因此对于这些新型显示设备，最好使用数字视频数据接口，如HDMI、DP等。

### 显卡

前面介绍显示器的时候，我们明白了CRT显示器是如何根据一串数据将图像显示在荧光屏上，也知道了这串数据是显卡输出的，这一部分介绍显卡输出的原理。显卡这个词可能有些歧义，或许“显示控制器”更合适一些，显卡通常是一个独立的硬件，有自己的存储器，其中存储的信息就是要现实在屏幕上的图像的二进制颜色编码，称作Framebuffer。还有一系列视频输出接口，其中就可能有之前介绍的VGA接口，在显存和VGA输出之间，是一块特制的电路，这块电路会自动读取Framebuffer中的内容，将其转换为各个接口需要的信号流。例如VGA接口，按照每秒60帧的频率，控制器需要将Framebuffer中的图像信息按照扫描线的顺序，编码成信号流，并在其中加入水平同步、垂直同步信号然后通过VGA接口发送。

这里解释一下Framebuffer和显存的关系。如果计算机要显示的内容非常简单，直接操作位图就可以了，如果知道显示器的分辨率，规定位图按行还是按列存储，软件完全能够自己用CPU生成需要显示的内容，即不断向Framebuffer写入数据，直到将整个位图的信息都写入为止。但在CPU进行内存读写是很慢的，如果显示的内容是动画，就需要CPU在显示每一帧之前都准备好这一帧的位图内容并写在Framebuffer里。随着显示器分辨率提高、颜色深度提高、动画帧率提升，以及更重要的，3D显示的出现，让CPU计算渲染位图并写Framebuffer变得压力越来越大。因此后来的显卡干脆改变这种显示方式，将Framebuffer和显存区分开来，Framebuffer中存储的仅仅是最终屏幕上显示的图像内容，这里的设置信息，包括分辨率、颜色深度等，都是向所连接的显示器查询后设置的。而显存中并不存放最终渲染好的画面，而是存放一些显示的元数据，例如在3D图形中，现存中可能存储一系列三角形的位置、颜色、材质等信息，显卡会根据显存中的信息，使用自身的专门硬件进行图像渲染，计算出真正要现实在屏幕上的图像的位图信息，并存放在Framebuffer中。

因此，早期的显示控制器仅仅负责把要显示的数据拿来，翻译成显示器能懂的信号，至于要先是什么内容，全部交给系统实现。后来的显卡则不进包含显示控制器的功能，还能够进行图像渲染等工作。总结起来，现代的显卡所包含的功能基本上有：
- 将内容显示到屏幕上（即最原始的视频控制器的功能）
- 2D/3D 加速
- 视频解码
- 科学计算

可以看到，显卡的功能很多，目前显卡也是非常复杂的一种设备，完全可以看做是计算机中的有一个计算机。因为目前的显卡有自己的处理器（GPU）、存储器（显存）、总线等，是一个自主程度相当高的组件。

在现在的计算机上，尤其是笔记本计算机，双显卡的配置是很常见的。配备的两个显卡通常一个叫集成显卡，另一个是独立显卡。集成显卡是主板的一部分，没有自己的存储器，而是使用系统内存工作。独立显卡拥有自己的专用内存、内部总线甚至包括风扇。虽然叫做独立显卡，但并不表示这块硬件是可拆卸的，仅仅表示它相对独立，有自己专用的存储器和总线而已。

但是之前提到，显卡也包括显示控制器的功能，即显卡也有自己的视频输出接口，可以向外发送视频信号，那么对于双显卡的计算机来说，到底由哪个显卡向外输出视频信号？这里涉及到双显卡的两种架构：

- 第一种称作 MUX 或 MUXed System。这种系统下，集显和独显都有视频输出接口，都可以向显示器输出信号，系统通过一个数据选择器（Multiplexer，简称 mux）控制哪一个显卡的输出信号传输到显示器上。
- 另一种称作 MUXless System，只有集成显卡能够输出视频信号，而独立显卡只能进行渲染和计算，不负责视频输出。

在笔记本上，通常集成显卡有自己的视频输出接口（在主板上），集成显卡不输出视频信息，仅负责显存到Framebuffer的渲染工作，同样输出到集成显卡的Framebuffer，由主板上的视频控制器进行输出。在台式机上，通常主板有集成显卡，因此也具有显示输出控制器。如果此时安装了 NVIDIA 和 AMD 的独立显卡，这些独立显卡一般也带有显示输出接口，如果使用独立显卡进行渲染，那么只能使用独显的输出接口，主板一般会关闭自带的视频输出。因此，台式机假装显卡之后，用户必须将显示器数据线接在独立显卡上的输出接口上。

### 早起显示技术
