---
title: "身份验证"
category: "开发"
tags: ["web", "node.js"]
---

Web 应用对用户进行身份验证的需求越来越多，一方面是用户系统越来越普及，另一方面是许多网站提供了 API，向第三方提供服务，而 API 的使用者同样需要进行身份验证。

### 传统身份验证方法

由于 HTTP 连接是无状态的，因此如果单纯地检验“用户名/密码”，则每次用户的请求都需要进行验证。传统的方法就是在服务器端存储用户的登录信息，也就是常说的 Session。

这样做有什么问题呢？首先，服务器需要保存用户的登录信息，不管是保存在文件里还是内存中，总要占用存储空间。此外存储在本地不适合机器集群的情况。此外，如果用户使用多设备登陆，session 信息在多设备之间的同步就非常麻烦。

### 基于 Token 的身份验证机制

基于 Token 的身份验证是无状态的，与 HTTP 一样，因此服务器不需要保存任何额外的信息。在这种机制下，进行身份验证的顺序是：

- 使用“用户名/密码”的组合申请访问权限。
- 服务器对“用户名/密码”进行校验，如果校验通过，则向客户端返回一个加密后的 token。
- 客户端将 token 保存下来，之后每次访问的时候，都把 token 放在 HTTP 报头之中。
- 每次服务器接收到请求，都去检查 token 是否合法，如果合法则继续。
