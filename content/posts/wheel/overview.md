---
title: "Wheel开发概览"
# kind: "article"
tags: []
---

这个类别用来记录wheel开发的过程，包括一些具体问题核解决方法，相关设计等。仅凭代码注释是完全不够的，因为代码注释不能详细的介绍某一方面的相关研究，以及选择某一种设计的具体原因。

### 代码组织方式（跨平台、可移植）

其实，代码组织是个人口味问题。我比较喜欢Linux内核的代码风格，所有变量都采用全小写，单词之间用下划线连接，必要的时候用缩写让代码简洁。

代码注释用英文，这样在编写代码的时候，就不用频繁地切换中英文输入法。而且注释不应该过多，只要能说明一段代码的作用就可以，让以后自己或别人看代码的时候，很快就能理解这段代码的逻辑。

注释要简单，但如果要记录比较详细的内容，就按照相关话题写在这个地方。

### 相关产品：INTEGRITY Multivisor

这是 INTEGRITY RTOS 的一款实时虚拟化解决方案，能够实现实时应用和分时应用的共存。与我们的需求比较一致。

![arch](https://www.ghs.com/products/images/multivisor_lg.jpg)

从架构图中可以看出，实时与分时的程序处在不同的层次中，实时程序直接运行在RTOS上，而分时的程序运行在一个 type-II 的虚拟机中，这个虚拟化产品再运行在RTOS上。

但是，这个产品应该不仅是一个 type-II hypervisor，而是这一整套架构。而且虽然这个 VMM 运行在操作系统之上，却和系统紧密联系起来，也可以认为是一个特殊的 type-I hypervisor，特殊在这个 hypervisor 不仅能够运行 VM，还能运行普通的实时任务。

INTEGRITY Multivisor 能够利用CPU提供的硬件虚拟化支持，如果硬件没有这种支持，那就通过动态指令替换，修改 guest OS 的二进制代码（因此支持的guestOS是有限的），替换成 hypervisor 的实现。而且在多核硬件上，用户还可以配置虚拟机如何使用各个CPU，可以将一个VM绑定在某个cpu上，也可以允许VM在CPU之间迁移，以平衡各个CPU的负载。